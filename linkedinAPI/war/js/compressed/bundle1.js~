function X2JS(y){var D="1.1.5";y=y||{};M();C();function M(){if(y.escapeMode===undefined){y.escapeMode=true}y.attributePrefix=y.attributePrefix||"_";y.arrayAccessForm=y.arrayAccessForm||"none";y.emptyNodeForm=y.emptyNodeForm||"text";if(y.enableToStringFunc===undefined){y.enableToStringFunc=true}y.arrayAccessFormPaths=y.arrayAccessFormPaths||[];if(y.skipEmptyTextNodesForObj===undefined){y.skipEmptyTextNodesForObj=true}if(y.stripWhitespaces===undefined){y.stripWhitespaces=true}y.datetimeAccessFormPaths=y.datetimeAccessFormPaths||[]}var N={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function C(){function a(b){var c=String(b);if(c.length===1){c="0"+c}return c}if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}}if(typeof Date.prototype.toISOString!=="function"){Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1000).toFixed(3)).slice(2,5)+"Z"}}}function A(a){var b=a.localName;if(b==null){b=a.baseName}if(b==null||b==""){b=a.nodeName}return b}function F(a){return a.prefix}function E(a){if(typeof(a)=="string"){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}else{return a}}function K(a){return a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}function I(e,d,b){switch(y.arrayAccessForm){case"property":if(!(e[d] instanceof Array)){e[d+"_asArray"]=[e[d]]}else{e[d+"_asArray"]=e[d]}break}if(!(e[d] instanceof Array)&&y.arrayAccessFormPaths.length>0){var a=0;for(;a<y.arrayAccessFormPaths.length;a++){var c=y.arrayAccessFormPaths[a];if(typeof c==="string"){if(c==b){break}}else{if(c instanceof RegExp){if(c.test(b)){break}}else{if(typeof c==="function"){if(c(e,d,b)){break}}}}}if(a!=y.arrayAccessFormPaths.length){e[d]=[e[d]]}}}function T(d){var b=d.split(/[-T:+Z]/g);var f=new Date(b[0],b[1]-1,b[2]);var c=b[5].split(".");f.setHours(b[3],b[4],c[0]);if(c.length>1){f.setMilliseconds(c[1])}if(b[6]&&b[7]){var e=b[6]*60+Number(b[7]);var a=/\d\d-\d\d:\d\d$/.test(d)?"-":"+";e=0+(a=="-"?-1*e:e);f.setMinutes(f.getMinutes()-e-f.getTimezoneOffset())}else{if(d.indexOf("Z",d.length-1)!==-1){f=new Date(Date.UTC(f.getFullYear(),f.getMonth(),f.getDate(),f.getHours(),f.getMinutes(),f.getSeconds(),f.getMilliseconds()))}}return f}function G(b,f,d){if(y.datetimeAccessFormPaths.length>0){var e=d.split(".#")[0];var a=0;for(;a<y.datetimeAccessFormPaths.length;a++){var c=y.datetimeAccessFormPaths[a];if(typeof c==="string"){if(c==e){break}}else{if(c instanceof RegExp){if(c.test(e)){break}}else{if(typeof c==="function"){if(c(obj,f,e)){break}}}}}if(a!=y.datetimeAccessFormPaths.length){return T(b)}else{return b}}else{return b}}function x(e,j){if(e.nodeType==N.DOCUMENT_NODE){var i=new Object;var g=e.childNodes;for(var h=0;h<g.length;h++){var f=g.item(h);if(f.nodeType==N.ELEMENT_NODE){var a=A(f);i[a]=x(f,a)}}return i}else{if(e.nodeType==N.ELEMENT_NODE){var i=new Object;i.__cnt=0;var g=e.childNodes;for(var h=0;h<g.length;h++){var f=g.item(h);var a=A(f);if(f.nodeType!=N.COMMENT_NODE){i.__cnt++;if(i[a]==null){i[a]=x(f,j+"."+a);I(i,a,j+"."+a)}else{if(i[a]!=null){if(!(i[a] instanceof Array)){i[a]=[i[a]];I(i,a,j+"."+a)}}(i[a])[i[a].length]=x(f,j+"."+a)}}}for(var d=0;d<e.attributes.length;d++){var c=e.attributes.item(d);i.__cnt++;i[y.attributePrefix+c.name]=c.value}var b=F(e);if(b!=null&&b!=""){i.__cnt++;i.__prefix=b}if(i["#text"]!=null){i.__text=i["#text"];if(i.__text instanceof Array){i.__text=i.__text.join("\n")}if(y.escapeMode){i.__text=K(i.__text)}if(y.stripWhitespaces){i.__text=i.__text.trim()}delete i["#text"];if(y.arrayAccessForm=="property"){delete i["#text_asArray"]}i.__text=G(i.__text,a,j+"."+a)}if(i["#cdata-section"]!=null){i.__cdata=i["#cdata-section"];delete i["#cdata-section"];if(y.arrayAccessForm=="property"){delete i["#cdata-section_asArray"]}}if(i.__cnt==1&&i.__text!=null){i=i.__text}else{if(i.__cnt==0&&y.emptyNodeForm=="text"){i=""}else{if(i.__cnt>1&&i.__text!=null&&y.skipEmptyTextNodesForObj){if((y.stripWhitespaces&&i.__text=="")||(i.__text.trim()=="")){delete i.__text}}}}delete i.__cnt;if(y.enableToStringFunc&&(i.__text!=null||i.__cdata!=null)){i.toString=function(){return(this.__text!=null?this.__text:"")+(this.__cdata!=null?this.__cdata:"")}}return i}else{if(e.nodeType==N.TEXT_NODE||e.nodeType==N.CDATA_SECTION_NODE){return e.nodeValue}}}}function H(c,h,d,g){var b="<"+((c!=null&&c.__prefix!=null)?(c.__prefix+":"):"")+h;if(d!=null){for(var f=0;f<d.length;f++){var e=d[f];var a=c[e];if(y.escapeMode){a=E(a)}b+=" "+e.substr(y.attributePrefix.length)+"='"+a+"'"}}if(!g){b+=">"}else{b+="/>"}return b}function L(b,a){return"</"+(b.__prefix!=null?(b.__prefix+":"):"")+a+">"}function B(b,a){return b.indexOf(a,b.length-a.length)!==-1}function z(b,a){if((y.arrayAccessForm=="property"&&B(a.toString(),("_asArray")))||a.toString().indexOf(y.attributePrefix)==0||a.toString().indexOf("__")==0||(b[a] instanceof Function)){return true}else{return false}}function J(b){var c=0;if(b instanceof Object){for(var a in b){if(z(b,a)){continue}c++}}return c}function S(b){var c=[];if(b instanceof Object){for(var a in b){if(a.toString().indexOf("__")==-1&&a.toString().indexOf(y.attributePrefix)==0){c.push(a)}}}return c}function O(b){var a="";if(b.__cdata!=null){a+="<![CDATA["+b.__cdata+"]]>"}if(b.__text!=null){if(y.escapeMode){a+=E(b.__text)}else{a+=b.__text}}return a}function R(b){var a="";if(b instanceof Object){a+=O(b)}else{if(b!=null){if(y.escapeMode){a+=E(b)}else{a+=b}}}return a}function P(c,e,b){var a="";if(c.length==0){a+=H(c,e,b,true)}else{for(var d=0;d<c.length;d++){a+=H(c[d],e,S(c[d]),false);a+=Q(c[d]);a+=L(c[d],e)}}return a}function Q(c){var b="";var g=J(c);if(g>0){for(var a in c){if(z(c,a)){continue}var e=c[a];var d=S(e);if(e==null||e==undefined){b+=H(e,a,d,true)}else{if(e instanceof Object){if(e instanceof Array){b+=P(e,a,d)}else{if(e instanceof Date){b+=H(e,a,d,false);b+=e.toISOString();b+=L(e,a)}else{var f=J(e);if(f>0||e.__text!=null||e.__cdata!=null){b+=H(e,a,d,false);b+=Q(e);b+=L(e,a)}else{b+=H(e,a,d,true)}}}}else{b+=H(e,a,d,false);b+=R(e);b+=L(e,a)}}}}b+=R(c);return b}this.parseXmlString=function(d){var f=window.ActiveXObject||"ActiveXObject" in window;if(d===undefined){return null}var b;if(window.DOMParser){var c=new window.DOMParser();var a=null;if(!f){try{a=c.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch(e){a=null}}try{b=c.parseFromString(d,"text/xml");if(a!=null&&b.getElementsByTagNameNS(a,"parsererror").length>0){b=null}}catch(e){b=null}}else{if(d.indexOf("<?")==0){d=d.substr(d.indexOf("?>")+2)}b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(d)}return b};this.asArray=function(a){if(a instanceof Array){return a}else{return[a]}};this.toXmlDateTime=function(a){if(a instanceof Date){return a.toISOString()}else{if(typeof(a)==="number"){return new Date(a).toISOString()}else{return null}}};this.asDateTime=function(a){if(typeof(a)=="string"){return T(a)}else{return a}};this.xml2json=function(a){return x(a)};this.xml_str2json=function(a){var b=this.parseXmlString(a);if(b!=null){return this.xml2json(b)}else{return null}};this.json2xml_str=function(a){return Q(a)};this.json2xml=function(b){var a=this.json2xml_str(b);return this.parseXmlString(a)};this.getVersion=function(){return D}};